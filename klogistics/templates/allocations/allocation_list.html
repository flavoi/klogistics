{% extends "base.html" %}

{% block title %}{{ season.name }}{% endblock title %}

{% block extrahead %}
<link rel='stylesheet' href="{{ STATIC_URL }}css/fullcalendar/scheduler.min.css">
{% endblock extrahead %}

{% block calendar_active %}active{% endblock calendar_active %}

{% block pagename %}Calendario{% endblock pagename %}

{% block content %}
    <div class="header text-center">
        <h3 class="title"></h3>
        <p class="category"></p>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card">            
                <div class="card-content" class="ps-child">
                <div id="calendar"></div>                    
                </div>
            </div>
        </div>
    </div>  
{% endblock content %}

{% block extrascript %}
<script src="{{ STATIC_URL }}js/fullcalendar/moment.min.js"></script>
<script src="{{ STATIC_URL }}js/fullcalendar/fullcalendar.min.js"></script>
<script src="{{ STATIC_URL }}js/fullcalendar/fullcalendar-lang-it.js""></script>
<script src="{{ STATIC_URL }}js/fullcalendar/scheduler.min.js"></script>
<script type="text/javascript">
    calendar = {
        initFullCalendar: function(){ 
            $calendar = $('#calendar');
            today = new Date();
            y = today.getFullYear();
            m = today.getMonth();
            d = today.getDate();
            $('#calendar').fullCalendar({
                schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
                header: {
                    left: 'title',
                    center: 'timelineMonth,timelineWeek,agendaDay,',
                    right: 'prev,next,today'
                },
                defaultDate: today,
                contentHeight: 'auto',
                businessHours: {
                    dow: [ 1, 2, 3, 4, 5 ], // Lunedì - Giovedì
                },
                defaultView: 'agendaDay',
                slotDuration: { days: 1 },
                resourceAreaWidth: '20%',
                resourceColumns: [
                    {
                        labelText: 'Persone',
                        field: 'title'
                    },
                ],
                resources: {
                    url: '{% url 'people:teamsjson' %}',
                    error: function() {
                        $('#script-warning').show();
                    }
                },
                events: {
                    url: '{% url 'allocations:season-json' season.pk %}',
                    error: function() {
                        $('#script-warning').show();
                    }
                },
                eventClick: function(date, jsEvent, view) { 
                    // Destinazione modal per eventi dell'utente                    
                    var h = $(this).attr('href');                
                    if (h != null) {
                        $(this).attr('data-target','#myModal');
                        $(this).attr('data-toggle','modal');
                    }
                },
            }); // Fine configurazione calendario
        } // Fine inizializzazione calendario
    } // Fine oggetto calendario
    $(document).ready(function() {
        calendar.initFullCalendar();
    });
</script>
{% endblock %}
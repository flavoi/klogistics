{% extends "base.html" %}

{% block extrahead %}
<link rel='stylesheet' href="{{ STATIC_URL }}css/fullcalendar/fullcalendar.min.css">
<link rel='stylesheet' href="{{ STATIC_URL }}css/fullcalendar/scheduler.min.css">
<script src="{{ STATIC_URL }}js/fullcalendar/moment.min.js"></script>
<script src="{{ STATIC_URL }}js/fullcalendar/fullcalendar.min.js"></script>
<script src="{{ STATIC_URL }}js/fullcalendar/fullcalendar-lang-it.js""></script>
<script src="{{ STATIC_URL }}js/fullcalendar/scheduler.min.js"></script>
<script>
    $(function() { // document ready

        $('#calendar').fullCalendar({
            schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
            defaultDate: '{{ season.start_date|date:"Y-m-d" }}',
            now: '{{ now }}',
            contentHeight: 'auto',
            editable: false, // enable draggable events
            header: {
                left: '',
                center: '',
                right: ''
            },
            businessHours: {
                // days of week. an array of zero-based day of week integers (0=Sunday)
                dow: [ 1, 2, 3, 4, 5 ], // Monday - Thursday
                start: '10:00', // a start time (10am in this example)
                end: '18:00', // an end time (6pm in this example)
            },
            defaultView: 'timelineFifteenDays',
            views: {
                timelineFifteenDays: {
                    type: 'timeline',
                    duration: { days: {{ season_duration }} }
                }
            },
            resourceAreaWidth: '20%',
            resourceColumns: [
                {
                    labelText: 'Persone',
                    field: 'title'
                },
            ],
            resources: {
                url: '{% url 'people:teamsjson' %}',
                error: function() {
                    $('#script-warning').show();
                }
            },
            slotDuration: { 
                days: 1,
            },
            events: {
                url: '{% url 'allocations:season-json' season.pk %}',
                error: function() {
                    $('#script-warning').show();
                }
            },
            eventMouseover: function(date, jsEvent, view) {
                // Aggiungi destinazione modal per eventi dell'utente
                var h = $(this).attr('href');                
                if (h != null) {
                    $(this).css('border-color', 'yellow');
                }
            },
            eventMouseout: function(date, jsEvent, view) {
                var c = $(this).css('backgroundColor');
                $(this).css('border-color', c);
            },
            eventClick: function(date, jsEvent, view) {
                // Aggiungi destinazione modal per eventi dell'utente
                var h = $(this).attr('href');                
                if (h != null) {
                    $(this).attr('data-target','#myModal');
                    $(this).attr('data-toggle','modal');
                }
            },
        });
    
    });
</script>
{% endblock extrahead %}

{% block title %}
  {{ season.name }}
{% endblock title %}

{% block content_title %}
    Periodo {{ season.start_date|date:"SHORT_DATE_FORMAT" }} - {{ season.end_date|date:"SHORT_DATE_FORMAT" }}
{% endblock content_title %}

{% block content %}
    <!-- Calendar -->
    <div id='calendar'></div>
{% endblock content %}